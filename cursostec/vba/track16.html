<html><head>
<title>VBA_track16</title>
<style type="text/css">
.dica {	width:500pt; background:aliceblue;color:#700080}
span {
font-family: 'Courier New';
font-size: 10pt;
color: #000000;
}
.sc0 {
}


.sc1 {
color: darkgreen;
font-weight: bold;
}

.sntx {
color: darkgreen;
}


.sc2 {
color: #008000;
}
.sc4 {
color: #ff8000;
}
.sc5 {
font-weight: bold;
color: #0000FF;
}
.sc6 {
color: #FF0000;
}
.sc9 {
color: #804000;
font-weight: bold;
}
.sc10 {
font-weight: bold;
color: #000080;
}
.sc11 {
}
.sc16 {
color: #400080;
}

.prg {
color: #0000FF;
}

.prg-saida {

margin-left:0px;
width:500pt;
background-color:lightblue;

}

.prg-code {
margin-left:0px;
width:500pt;
background-color:lightyellow;
padding:10px;
font-weight:bold;
}


.niceview {
margin-left:0px;
width:500pt;
background-color:white;
border-color:lightgray;
border-width:1px;
border-style:solid;
padding:10px;
}

td
{
padding:3px;
}

table.dados
{

margin-left:0px;
width:53.5em;
border-collapse:collapse;
border:1px solid red;
text-align:center;
}

th
{
background-color:darkgreen;
color:yellow;
font-weight:bold;
text-transform:uppercase;
}
body
{
margin-left:60px;
}
.pagebody
{
padding:10px;
margin-left:50px;
border-width:1px;
border-style:solid;
border-color:white;
background-color:white;
width:90%;
-webkit-border-radius: 40px 40px 40px 40px;
-moz-border-radius: 40px 40px 40px 40px;
border-radius: 15px 15px 15px 15px;
}
.mybody
{
margin-top:20pt;
margin-bottom:20pt;
margin-left:20pt;
margin-right:20pt;
/* border-width:1px; */
/* border-style:solid; */
border-color:lightgray;
background-image:url('bg_azul.png');
}
</style>
</head>
<body class=mybody><font color="black">
<div class=pagebody>
<hr>
<center><b>GAMEPROG - Escola de produção de software: aplicativos e jogos digitais</b><br>
<b>Contato: Jair Pereira - gameprog.br@gmail.com</b><br>
<b>Curso completo de Visual Basic for Applications (VBA) </b><br>
<b>track16.html</b><br></center><hr>
<table align=bottom border=0 cellspacing=0 cellpadding=0 width=20%>
<tr><td><a href=vba.html style='color:blue'> index </a></td>
<td><a href='track15.html'style='color:blue'>&lt;&lt;</a></td>
<td><a href='track17.html'style='color:blue'>&gt;&gt;</a></td></tr></table>
<br><hr><a name='track01'></a><h3 style='background-color:blue;color:yellow;'>0X. This is about...</h3><pre>
<h3><u> 16. Estruturas</u></h3>                                                                                         
                                                                                                                        
        Os tipos de dados comuns você já conhece: INTEGER, STRING, SINGLE, DOUBLE,                                      
        e Matrizes.                                                                                                     
                                                                                                                        
        Você pode criar um tipo de dado pessoal combinando estes tipos de dados                                         
        primários. Para isso você usa o bloco <font color="darkblue"><b>TYPE...END TYPE</b></font>                      
                                                                                                                        
        Vamos supor que num jogo de videogame você deseja ter 10                                                        
        inimigos do mesmo tipo espalhado pela tela. Você cria                                                           
        assim esse tipo de inimigo:<font color="darkblue"><b>                                                           
                                                                                                                        
        TYPE inimigo                                                                                                    
        energia aS INTEGER                                                                                              
        balas as INTEGER                                                                                                
        xposition AS INTEGER                                                                                            
        yposition AS INTEGER                                                                                            
        nome AS STRING * 20                                                                                             
        END TYPE</b></font>                                                                                             
                                                                                                                        
        Dentro do corpo do <b>TYPE</b> você declara as variáveis que vão fazer                                          
        parte deste novo tipo de dado, também chamado de estrutura ou                                                   
        registro por conter agrupadas várias variáveis.                                                                 
        A declaração da variável string deve ser seguida do tamanho                                                     
        máximo desta string. Você faz isso usando um asterisco seguido                                                  
        do tamanho dela.                                                                                                
                                                                                                                        
        Como você criou um novo tipo de dado, você deve declarar uma variável                                           
        com este novo tipo para você poder usar esta estrutura. Isto faz-se                                             
        do jeito usual de declarar variáveis:<font color="darkblue"><b>                                                 
                                                                                                                        
        DIM NomeDaVariável AS NomeDaEstrutura                                                                           
        DIM HomemMau as inimigo</b></font>                                                                              
                                                                                                                        
        O uso da estrutura é interessante, você grava e recupera assim                                                  
        os valores:<font color="darkblue">                                                                              
                                                                                                                        
        HomemMau.energia = 20                                                                                           
        HomemMau.balas = 50                                                                                             
        HomemMau.xposition=13                                                                                           
        HomeMau.yposition=20                                                                                            
        HomemMau.nome = "Drácula"                                                                                       
                                                                                                                        
        PRINT "Energia: ",STRING$(HomeMau.Energia,"*")</font>                                                           
                                                                                                                        
        Neste exemplo, nós só temos um inimigo no jogo. Para criar                                                      
        os 10 que citamos, criamos matrizes do tipo inimigo:<font color="darkblue">                                     
                                                                                                                        
        DIM HomemMau(10) as inimigo</font>                                                                              
                                                                                                                        
        A referência aos elementos da matriz HomemMau é assim:<font color="darkblue">                                   
                                                                                                                        
        HomemMau(1).energia = 20                                                                                        
        HomemMau(1).balas = 50                                                                                          
        HomemMau(8).xposition=13                                                                                        
        HomeMau(2).yposition=20                                                                                         
        HomemMau(5).nome = "Drácula"</font>                                                                             
                                                                                                                        
        <u>Outro exemplo de estrutura</u>                                                                               
        As estruturas são bastante usadas em programas comerciais para                                                  
        manter registro de clientes, produtos etc.:<font color="darkblue">                                              
                                                                                                                        
        TYPE pessoa                                                                                                     
        nome As STRING * 20                                                                                             
        endereco AS STRING * 20                                                                                         
        telefone AS STRING * 20                                                                                         
        END TYPE                                                                                                        
                                                                                                                        
        DIM cliente(100) AS pessoa                                                                                      
        cliente(1).nome = "Renata Azevedo"                                                                              
        cliente(1).Endereco = "Rua Pedro I,202"                                                                         
        cliente(1).Telefone = "(11) 5555-7777"</font>                                                                   
                                                                                                                        
<hr>                                                                                                                    

<table align=bottom border=0 cellspacing=0 cellpadding=0 width=20%>
<tr><td><a href=vba.html style='color:blue'> index </a></td>
<td><a href='track15.html'style='color:blue'>&lt;&lt;</a></td>
<td><a href='track17.html'style='color:blue'>&gt;&gt;</a></td></tr></table>
<hr><pre><div style='background-color:lightyellow;color:blue'>
<center>Produzido por Gameprog: Jair Pereira - Fev/2006 - Dez/2013 ©
gameprog.br@gmail.com
<a href='http://www.gameprog.com.br'>http://www.gameprog.com.br</a></center><hr></div></div></body></html>
