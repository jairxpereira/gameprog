<html><head>
<title>CVip_track24</title>
<style type="text/css">
.dica {	width:500pt; background:aliceblue;color:#700080}
span {
font-family: 'Courier New';
font-size: 10pt;
color: #000000;
}
.sc0 {
}


.sc1 {
color: darkgreen;
font-weight: bold;
}

.sntx {
color: darkgreen;
}


.sc2 {
color: #008000;
}
.sc4 {
color: #ff8000;
}
.sc5 {
font-weight: bold;
color: #0000FF;
}
.sc6 {
color: #FF0000;
}
.sc9 {
color: #804000;
font-weight: bold;
}
.sc10 {
font-weight: bold;
color: #000080;
}
.sc11 {
}
.sc16 {
color: #400080;
}

.prg {
color: #0000FF;
}

.prg-saida {

margin-left:0px;
width:500pt;
background-color:lightblue;

}

.prg-code {
margin-left:0px;
width:500pt;
background-color:lightyellow;
padding:10px;
font-weight:bold;
}


.niceview {
margin-left:0px;
width:500pt;
background-color:white;
border-color:lightgray;
border-width:1px;
border-style:solid;
padding:10px;
}

td
{
padding:3px;
}

table.dados
{

margin-left:0px;
width:53.5em;
border-collapse:collapse;
border:1px solid red;
text-align:center;
}

th
{
background-color:darkgreen;
color:yellow;
font-weight:bold;
text-transform:uppercase;
}
body
{
margin-left:60px;
}
.pagebody
{
margin-left:50px;
border-width:1px;
border-style:solid;
border-color:white;
background-color:white;
width:90%;
-webkit-border-radius: 40px 40px 40px 40px;
-moz-border-radius: 40px 40px 40px 40px;
border-radius: 15px 15px 15px 15px;
}
.mybody
{
margin-top:20pt;
margin-bottom:20pt;
margin-left:20pt;
margin-right:20pt;
/* border-width:1px; */
/* border-style:solid; */
border-color:lightgray;
background-image:url('backdrop.jpg');
}
</style>
</head>
<body class=mybody><font color="black">
<div class=pagebody>
<hr>
<center><b style="font-size:1.5em;" >Curso completo de linguagem C</b><br>
Gameprog - Escola de programação de jogos digitais<br>
Contato: gameprog.br@gmail.com<br>
<b>track24.html</b></center>
<hr>
<table align=bottom border=0 cellspacing=0 cellpadding=0 width=20%><tr>
<td><a href=cvip.html style='color:blue'> index </a></td><td><a href='track23.html'style='color:blue'>&lt;&lt;</a></td>
<td><a href='track25.html'style='color:blue'>&gt;&gt;</a></td></tr></table>
<hr><pre>
<a name="track24"></a><h3 style="background-color:#80ff80">24. Funções recursivas e saltos incondicionais</h3>
<b style="background-color:lightgreen">24.1 Funções recursivas </b>
	
Funções recursivas são simplesmente funções que chamam a  si  mesmas.
Não   é  necessário  nenhuma  sintaxe  especial  para  criar  funções
recursivas,  basta apenas fazer uma chamada dessa função dentro de si
mesma.

O  uso  de  funções  recursivas  deve  ser cercado de cuidados pois é
necessário   definir  uma  condição  na  qual  a  função  deve  parar
de  chamar  a  si  mesma   para     evitar    um    laço    infinito.

Um  outro  fato  que  é  importante   entender  sobre  funções é  que
internamente a  chamada  de  uma  função qualquer  é  um  salto  para
uma  outra  região  de  memória  aonde está o código executável desta
função. 

Antes de fazer  este  salto,  o processador  que executa seu programa
faz  um  trabalho   de  preservar  valores  e variáveis  que estão em
processo; o processador guarda a posição de memória  aonde  ele  está
antes de fazer o salto pois ao término da execução da função ele deve
retornar  ao  último    ponto  em  que  estava  antes da chamada para
continuar  a  execução  linear  do programa  que é a direção do fluxo
normal de execução.

Este trabalho de preservar  valores  e  posição  de  execução demanda
tempo  e  memória,  o  que faz da função recursiva um ponto fraco  no
programa      pois      isso      será    feito      muitas    vezes.

O uso de funções recursivas pode também dificultar a  compreensão  da
lógica do programa, pois uma função  que  chamou  a  si  mesma tantas
vezes  retornará  para  si  mesma tantas vezes na linha abaixo de sua
chamada, o  que  pode  apresentar  efeitos  colaterais imprevisíveis.

Repetimos  que  o  uso  de  funções  recursivas  deve  ser cercado de
precauções devido aos fatos que expomos acima.  Veja abaixo o exemplo
que   ilustra   a   implementação   de      uma   função   recursiva:

<div class=prg-saida>
 <img src=images\recursiv.png>
<br></div>
<div class=prg-code>
<span class="sc1">/* Programa: recursiv.c track 24            */</span><span class="sc0">
</span><span class="sc1">/* Testando recursividade                   */</span><span class="sc0">
</span><span class="sc9">#include "stdio.h"
#include "stdlib.h"
</span><span class="sc0">
</span><span class="sc1">/* Protótipos */</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">initSys</span><span class="sc10">(</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">title</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">recursiva</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc16">long</span><span class="sc0"> </span><span class="sc11">fatorial</span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">nval</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc16">long</span><span class="sc0"> </span><span class="sc11">myfat</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc1">/* ------------------ Função main()  ----------------------- */</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">main</span><span class="sc10">(</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">nCmd</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">sCmd</span><span class="sc10">[])</span><span class="sc0">   </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">initSys</span><span class="sc10">(</span><span class="sc6">"title recursiv.c"</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc1">/* --- Esta função chama a si mesma 5x --------------------- */</span><span class="sc0">
</span><span class="sc11">myfat</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">fatorial</span><span class="sc10">(</span><span class="sc4">5</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc11">printf</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc6">" Fatorial 5!: %li \n\n"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">myfat</span><span class="sc10">);</span><span class="sc0">


</span><span class="sc1">/* --- Esta função chama a si mesma 5x --------------------- */</span><span class="sc0">
</span><span class="sc11">recursiva</span><span class="sc10">();</span><span class="sc0">

</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"\n\n"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">getchar</span><span class="sc10">();</span><span class="sc0">
</span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">


</span><span class="sc1">/* ------------------ Função recursiva()  ----------------- */</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">recursiva</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc16">static</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">nCiclo</span><span class="sc10">=</span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">nOldCiclo</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc11">nOldCiclo</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">nCiclo</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">" nCiclo: %d \t nOldCiclo: %d\n"</span><span class="sc10">,</span><span class="sc11">nCiclo</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">nOldCiclo</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">nCiclo</span><span class="sc10">++;</span><span class="sc0">

</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">nCiclo</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">6</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"\n"</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc1">/* --- Controle da recursividade abaixo ------------------- */</span><span class="sc0">
</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">nCiclo</span><span class="sc0"> </span><span class="sc10">&lt;=</span><span class="sc0"> </span><span class="sc4">5</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc11">recursiva</span><span class="sc10">();</span><span class="sc0">


</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">nCiclo</span><span class="sc0"> </span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc4">5</span><span class="sc10">)</span><span class="sc0">
 </span><span class="sc10">{</span><span class="sc0">
 </span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">" Ciclo encerrado:%d "</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">nCiclo</span><span class="sc10">);</span><span class="sc0">
 </span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"\t Ciclo antigo:%d\n"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">nOldCiclo</span><span class="sc10">);</span><span class="sc0">
 </span><span class="sc10">}</span><span class="sc0">

</span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">


</span><span class="sc1">/* ------------------ Função initSys()  -------------------- */</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">initSys</span><span class="sc10">(</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">title</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
</span><span class="sc1">/* Configura a janela */</span><span class="sc0">
</span><span class="sc11">system</span><span class="sc10">(</span><span class="sc11">title</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">system</span><span class="sc10">(</span><span class="sc6">"color F1"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"\n\n"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">


</span><span class="sc1">/* ------------------ Função fatorial()  ------------------- */</span><span class="sc0">
</span><span class="sc16">long</span><span class="sc0"> </span><span class="sc11">fatorial</span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">nval</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
</span><span class="sc16">static</span><span class="sc0"> </span><span class="sc16">long</span><span class="sc0"> </span><span class="sc11">fat</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">static</span><span class="sc0"> </span><span class="sc16">long</span><span class="sc0"> </span><span class="sc11">resultado</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc11">fat</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">fat</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">nval</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc1">/* --- Controle da recursividade abaixo ------------------- */</span><span class="sc0">
</span><span class="sc11">nval</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">nval</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc11">printf</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc6">" fat: %li nval: %i \n"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">fat</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">nval</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">nval</span><span class="sc0"> </span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc11">fatorial</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">nval</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">nval</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
 </span><span class="sc11">resultado</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">fat</span><span class="sc10">;</span><span class="sc0">
 </span><span class="sc11">fat</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc5">return</span><span class="sc0"> </span><span class="sc11">resultado</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0"></div>

No programa acima definimos uma variável estática <b>nCiclo</b> que controla
o   número   de   vezes   de   execução   da   função     que    será
finalizada    quando    nCiclo    for    maior   ou  igual  a  cinco.

Dentro  da  função  recursiva  tem  uma variável local nOldCiclo, que
aparece  apenas  para  ilustrar que ocorre o preservamento de valores
quando ocorre salto a uma função;  esta  preservação se dá porque uma
outra função foi  chamada  não esgotando o tempo de uso das variáveis
locais que se daria com  a instrução <b>return.</b>

Veja  no  exemplo  que  depois que a função encontra  a  condição  de
parar  de  chamar  a  si mesma, ela volta para  dentro  de  si  mesma
tantas  vezes  quanto  foi  chamada e que as variáveis locais tiveram
os  seus  valores  salvos  nos ciclos anteriores, valores  estes  que
foram  recuperados  e  mostrados  no  exemplo.

Outro  ponto  que  se  deve destacar do exemplo é que quando a função
parou  de  chamar  a  si mesma ela retornou  para  si  mesma  de  uma
maneira  decrescente,  que  ficou  evidenciado por mostrar os valores
de  nOldCiclo  de  maneira  decrescente, valores assumidos durante os
ciclos.  Este  decrescimento  é  a  lógica  correta  do  processo  de
retorno  pois  a  ordem  de execução  do  programa  deve  ser  sempre
restabelecida  ao  último  ponto  em que se estava antes  da  chamada
da função.

Todo  programa  tem  uma  área  de memória reservada chamada stack ou
pilha.  A  pilha  serve  principalmente  para guardar  os  argumentos
de  entrada  e  de  retorno  de uma função e aonde se está  na  ordem
de  execução  de  um  programa,  ponto  para  o  qual  deve  haver  o
retorno    depois    do   término   de   uma   função   chamada.  Uma
característica  marcante  e  determinante  da  pilha  é  que o último
valor  colocado  é  o  primeiro  valor que deve  sair  tal  como  uma
pilha  de  pratos  aonde  o  primeiro a ser lavado é do topo pois foi
o  último  a  ser  colocado e é o mais fácil de  ser  retirado.  Esta
organização  da  pilha  é  a  fato que forçou no programa  exemplo  a
visualização  dos  valores   de  nOldCiclo  de  maneira  decrescente.

<b style="background-color:lightgreen">24.2 goto - Salto incondicional</b>

Você  pode  realizar,  dentro  da  função  e  somente  para dentro da
mesma  função,  um  salto  incondicional    utilizando   a  instrução
<b>goto</b> para isso.

Você  primeiro  deve  rotular  um  trecho  do  seu  programa  com  um
nome     qualquer     seguido     de    dois    pontos    (:).    Ex:
<b style="color:green">
Comeco:
código;
goto Comeco;</b>
<font color="darkblue">
start:
ncx++;
if (ncx==10) goto Final;
goto start;
Final:
return 0;</font>

Você  deve  ter  cuidado para não criar com goto um looping infinito.
O  uso  do  salto  incondicional raramente  é utilizado; o retrocesso
sempre    acarreta    uma pequena perda de tempo.  Alguns  chegam  ao
exagero  de  afirmar  que o seu uso  é  deselegante  em  programação.
	
<div class=prg-saida>
 <img src=images\xgoto.png>
<br></div>
<div class=prg-code>
<span class="sc1">/* Programa: xgoto.c - track 24             */</span><span class="sc0">
</span><span class="sc1">/* Ilustra salto incondicional        */</span><span class="sc0">
</span><span class="sc9">#include "stdio.h"                                                                                              
#include "stdlib.h"  
</span><span class="sc0">
</span><span class="sc1">/* Protótipos */</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">initSys</span><span class="sc10">(</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">title</span><span class="sc10">);</span><span class="sc0"> 

</span><span class="sc1">/* ------------------ Função main()  -------------------- */</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">main</span><span class="sc10">(</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">nCmd</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">sCmd</span><span class="sc10">[])</span><span class="sc0">   </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">ncx</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc11">initSys</span><span class="sc10">(</span><span class="sc6">"title xgoto.c"</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc11">Start</span><span class="sc10">:</span><span class="sc0">
</span><span class="sc11">ncx</span><span class="sc10">++;</span><span class="sc0">
</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">" %d.salto incondicional \n"</span><span class="sc10">,</span><span class="sc11">ncx</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">ncx</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">3</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc5">goto</span><span class="sc0"> </span><span class="sc11">Final</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc5">goto</span><span class="sc0"> </span><span class="sc11">Start</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc11">Final</span><span class="sc10">:</span><span class="sc0">
</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"\n Final do programa...\n\n"</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc11">getchar</span><span class="sc10">();</span><span class="sc0">
</span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc1">/* ------------------ Função initSys()  -------------------- */</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">initSys</span><span class="sc10">(</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">title</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
</span><span class="sc1">/* Configura a janela */</span><span class="sc0">
</span><span class="sc11">system</span><span class="sc10">(</span><span class="sc11">title</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">system</span><span class="sc10">(</span><span class="sc6">"color F1"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"\n\n"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span></div>
<hr>
<table align=bottom border=0 cellspacing=0 cellpadding=0 width=20%><tr><td><a href=cvip.html style='color:blue'> index </a></td><td><a href='track23.html'style='color:blue'>&lt;&lt;</a></td><td><a href='track25.html'style='color:blue'>&gt;&gt;</a></td></tr></table><hr><div style='background-color:lightyellow;color:blue'>
<center>Produzido por Gameprog: Jair Pereira - Fev/2006 - Junho/2013 ©
gameprog.br@gmail.com
<a href='http://www.gameprog.com.br'>http://www.gameprog.com.br</a></center><hr></div></div></body></html>
