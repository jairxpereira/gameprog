<html>
<head>
<title>mdx9_fase1-3</title>
<head>
<style type="text/css">

span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}


.sc1 {
	color: darkgreen;
	font-weight: bold;
}

.sntx {
	color: darkgreen;
	}


.sc2 {
	color: #008000;
}
.sc4 {
	color: #ff8000;
}
.sc5 {
	font-weight: bold;
	color: #0000FF;
}
.sc6 {
	color: #FF0000;
}
.sc9 {
	color: #804000;
	font-weight: bold;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc11 {
}
.sc16 {
	color: #400080;
}

.prg {
	color: #0000FF;
}

.prg-saida {

	margin-left:0px;
	width:500pt;
	background-color:lightblue;
	
}

.prg-code {
	margin-left:0px;
	width:515pt;
	background-color:lightyellow;
	padding:10px;
	font-weight:bold;
}


.niceview {
	margin-left:0px;
	width:500pt;
	background-color:white;
	border-color:lightgray;
	border-width:1px;
	border-style:solid;
	padding:10px;
}

td
{
padding:3px;
}

table.dados
{

margin-left:0px;
width:53.5em;
border-collapse:collapse;
border:1px solid red;
text-align:center;


}

th
{
background-color:darkgreen;
color:yellow;
font-weight:bold;
text-transform:uppercase;
}

.pagebody
{
padding:10px;
margin-left:50px;
border-width:1px;
border-style:solid;
border-color:white;
background-color:white;
width:90%;
}
.mybody
{
margin-top:20pt;
margin-bottom:20pt;
margin-left:20pt;
margin-right:20pt;
border-color:lightgray;
background-image:url('background.png');
}
</style>
<body class=mybody><font color="black">
<div class=pagebody>
<hr>
<center><b style="font-size:1.5em;" >Curso completo de DirectX Gerenciado</b><br>
Gameprog - Escola de programação de jogos digitais<br>
Contato: gameprog.br@gmail.com<br>
<b>Fase 1-3</b></center>
<hr>
<table align="left" border="0" cellspacing="0" cellpadding="0" width="20%">
<tr><td><a href="mdx9.html#start" style="color:blue"> index </a></td>
<td><a href="track01-2.html" style="color:blue">&lt;&lt;</a></td>
<td><a href="track01-4.html" style="color:blue">&gt;&gt;</a></td></tr></table><br><pre>

<hr><a name="track01"></a>
<h3 style="background-color:#80ff80">1.3 O primeiro triângulo</h3><pre>

<b><u>1.1 Visão geral</b></u>
<div class=prg-code>
<img src=images\prj_Triangulo.png></div>
O triângulo é a menor célula de um objeto tridimensional. O triângulo
acima  é  composto  por  3  vértices  cada  um contendo informação de 
posição na forma (x, y, z). 

Cada  vértice  recebe ainda informação  de  intensidade  de  cor.  No 
triângulo acima  os  vértices tem uma cor básica de vermelho, verde e 
azul  que  se  esparramam e  se misturam  pelo  triângulo com a mesma 
intensidade.

Ainda para ter o triângulo  ou  qualquer  outra  forma  desenhada, os 
vértices  precisam  ser  posicionados seguindo uma direção regular do
relógio na linha horária ou anti-horária.  No  triângulo  acima foram
colocados  primeiro o vértice vermelho <b>p0</b>, depois  o vértice verde <b>p1</b>
e por último o vértice azul <b>p2</b>; ou seja,  os  vértices  seguiram  uma
direção horária.

<u>Tranformações</u>
Normalmente, um triângulo para ser exibido sofre ainda  uma sequência 
de operações matemáticas ou geométricas chamadas  <b>transformações</b>.  No 
triângulo acima  cada vértice está posicionado com relação aos outros
vértices do próprio triângulo, esse posicionamento é chamado de <b>espaço
local</b>. Quando o triângulo ou objeto é posicionado em um mundo virtual
ocorre a primeira transformação quando seus vértices são recalculados
para posicionar de fato o objeto neste mundo virtual.

Nessa primeira transformação, o objeto é transportado do <b>espaço local</b>
para o <b>espaço mundial</b>. Mas para ser visto o objeto precisa ser trazido
do espaço mundial para o <b>espaço de tela</b> ou  <b>espaço  de  visualização</b>.
Geralmente  estas  transformações  são multiplicações matemáticas que 
são feitas no posicionamento dos vértices até chegar na posição (x,y)
final do vértice para compor a imagem na tela.

Falamos sobre a transformação de posicionamento chamada de <b>translação</b> 
mas existem outras e mais outras  para aplicação  de escala, rotação, 
correções de visualização e aplicação de efeitos especiais.

<u>Formato de vértice</u>
Nosso triângulo não vai sofrer  nenhuma  transformação  uma  vez  que
vamos  passar  a  coordenada  2D  final  do  vértice  acompanhada  da
informação de cor.  Dizemos  então que o <b>formato  de vértice</b> do nosso 
triângulo é <b>transformado e colorido</b>, <b class=prg>TransformedColored</b> como  se  diz
em  DirectX  gerenciado. Outros	 formatos  de  vértice  podem  incluir 
informações sobre texturas ou  posicionamento que vai sofrer cálculos
futuros de transformações.

<b><u>1.2 Estrutura da aplicação</b></u>
<img src=images\diagrama_prj_Triangulo.png>
Conforme diagrama temos uma array <b>triangulo</b> que vai receber informação
de cor e posicionamento sobre os vértices que vão compor o triângulo a
ser visualizado. 

Vamos ter no corpo da classe a função <b>montar_triangulo()</b> que vai fazer
o que seu nome diz. A função <b>Renderizar()</b> irá definir o tipo de vértice,
montar o triângulo com  a  função  auxiliar  acima  e  vai  mostrá-lo.

<b><u>2.1 Definindo o recipiente para o triângulo</b></u>
<div class=niceview>
<span class="sc5">public</span><span class="sc0"> </span><span class="sc11">partial</span><span class="sc0"> </span><span class="sc16">class</span><span class="sc0"> </span><span class="sc11">Tela</span><span class="sc0"> </span><span class="sc10">:</span><span class="sc0"> </span><span class="sc11">Form</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc5">private</span><span class="sc0"> </span><span class="sc11">Device</span><span class="sc0"> </span><span class="sc11">device</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">null</span><span class="sc10">;</span><span class="sc0">     </span><span class="sc2">// Para criação do dispositivo gráfico
</span><span class="sc0">    </span><span class="sc5">private</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">cor_fundo</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0xFFFFFF</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc2">// Branco cor de fundo para nossa janela   
</span><span class="sc0">
    </span><span class="sc2"><b>// Vértices com configuração de posição e cor
</span><span class="sc0">    </span><span class="sc5">private</span><span class="sc0"> </span><span class="sc11">CustomVertex</span><span class="sc10">.</span><span class="sc11">TransformedColored</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc11">triangulo</span><span class="sc10">;</span><span class="sc0">
</b>
    </span><span class="sc2">// Construtor()
</span><span class="sc0">    </span><span class="sc5">public</span><span class="sc0"> </span><span class="sc11">Tela</span><span class="sc10">()</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
      </span><span class="sc2">// Qualquer configuração em algum componente, faça depois dessa função!
</span><span class="sc0">      </span><span class="sc2">// Pois a geração automática de código pode suprimir algo que você
</span><span class="sc0">      </span><span class="sc2">// fizer antes dela
</span><span class="sc0">      </span><span class="sc11">InitializeComponent</span><span class="sc10">();</span><span class="sc0">

      </span><span class="sc2">// Toda renderização deverá ocorrer dentro do evento onPaint()
</span><span class="sc0">      </span><span class="sc2">// Isso evita interferência estrangeira de processamento default
</span><span class="sc0">      </span><span class="sc2">// do sistema Windows
</span><span class="sc0">      </span><span class="sc5">this</span><span class="sc10">.</span><span class="sc11">SetStyle</span><span class="sc10">(</span><span class="sc11">ControlStyles</span><span class="sc10">.</span><span class="sc11">AllPaintingInWmPaint</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc11">ControlStyles</span><span class="sc10">.</span><span class="sc11">Opaque</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">true</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0"> </span><span class="sc2">// fim do construtor
</span><span class="sc0">    
    </span><span class="sc2">// (...)
</span><span class="sc0">    
</span><span class="sc10">}</span><span class="sc0"> </span><span class="sc2">// fim da classe
</span></div>

<b class=prg>private CustomVertex.TransformedColored</b>[] triangulo;
Esta estrutura foi definida aqui neste escopo porque precisa ser vista
na função que vai montar o triângulo e na função que vai renderizar o
triângulo. A  variável  <b>triangulo</b>  é  o  recipiente que vai conter os
vértices do triângulo com  informação  de  cor  e  posicionamento.  O
posicionamento desse tipo de vértice é dado em  números absolutos não 
cabendo transformações posteriores.

<b><u>2.2 Montando o triângulo</b></u>
<div class=niceview>
<span class="sc5">public</span><span class="sc0"> </span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">montar_triangulo</span><span class="sc10">()</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
  </span><span class="sc2">// Pega as dimensões da tela
</span><span class="sc0">  </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">altura</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">this</span><span class="sc10">.</span><span class="sc11">Height</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">largura</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">this</span><span class="sc10">.</span><span class="sc11">Width</span><span class="sc10">;</span><span class="sc0">

  </span><span class="sc2">// Cores para os vértices
</span><span class="sc0">  </span><span class="sc16">const</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">vermelho</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0xFF0000</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc16">const</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">verde</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0x00FF00</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc16">const</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">azul</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0x0000FF</span><span class="sc10">;</span><span class="sc0">

  </span><span class="sc2">// É necessário 3 vértices para compor o triângulo
</span><span class="sc0">  </span><span class="sc11">triangulo</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">CustomVertex</span><span class="sc10">.</span><span class="sc11">TransformedColored</span><span class="sc10">[</span><span class="sc4">3</span><span class="sc10">];</span><span class="sc0">
  
  </span><span class="sc2">// Vetores para guardar a posição (x,y,z) dos vértices e 
</span><span class="sc0">  </span><span class="sc2">// informação de cor
</span><span class="sc0">  </span><span class="sc11">Vector4</span><span class="sc0"> </span><span class="sc11">p0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">p1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">p2</span><span class="sc10">;</span><span class="sc0">

  </span><span class="sc2">// O tamanho do triangulo vai adaptar-se interativamente
</span><span class="sc0">  </span><span class="sc2">// ao tamanho da janela
</span><span class="sc0">  </span><span class="sc16">float</span><span class="sc0"> </span><span class="sc11">meia_largura</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">largura</span><span class="sc0"> </span><span class="sc10">/</span><span class="sc0"> </span><span class="sc4">2.0f</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc16">float</span><span class="sc0"> </span><span class="sc11">larg_80p</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">largura</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc0"> </span><span class="sc4">0.8f</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc16">float</span><span class="sc0"> </span><span class="sc11">larg_20p</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">largura</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc0"> </span><span class="sc4">0.2f</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc16">float</span><span class="sc0"> </span><span class="sc11">alt_80p</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">altura</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc0"> </span><span class="sc4">0.8f</span><span class="sc10">;</span><span class="sc0">

  </span><span class="sc2">// Posicionamento de profundidade
</span><span class="sc0">  </span><span class="sc16">float</span><span class="sc0"> </span><span class="sc11">zpos</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc4">0.5f</span><span class="sc10">;</span><span class="sc0">
  
  </span><span class="sc2">// Intensidade de propagação de cor do vértice
</span><span class="sc0">  </span><span class="sc16">float</span><span class="sc0"> </span><span class="sc11">p0_cor_intensidade</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">1.0f</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc16">float</span><span class="sc0"> </span><span class="sc11">p1_cor_intensidade</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">1.0f</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc16">float</span><span class="sc0"> </span><span class="sc11">p2_cor_intensidade</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">1.0f</span><span class="sc10">;</span><span class="sc0">

  </span><span class="sc2">// Define a cor dos vértices
</span><span class="sc0">  </span><span class="sc11">triangulo</span><span class="sc10">[</span><span class="sc4">0</span><span class="sc10">].</span><span class="sc11">Color</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">vermelho</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">triangulo</span><span class="sc10">[</span><span class="sc4">1</span><span class="sc10">].</span><span class="sc11">Color</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">verde</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">triangulo</span><span class="sc10">[</span><span class="sc4">2</span><span class="sc10">].</span><span class="sc11">Color</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">azul</span><span class="sc10">;</span><span class="sc0">

  </span><span class="sc2">// Posições para os 3 vértices do triangulo
</span><span class="sc0">  </span><span class="sc11">p0</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">Vector4</span><span class="sc10">(</span><span class="sc11">meia_largura</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">50.0f</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">zpos</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">p0_cor_intensidade</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">p1</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">Vector4</span><span class="sc10">(</span><span class="sc11">larg_80p</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">alt_80p</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">zpos</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">p1_cor_intensidade</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">p2</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">Vector4</span><span class="sc10">(</span><span class="sc11">larg_20p</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">alt_80p</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">zpos</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">p2_cor_intensidade</span><span class="sc10">);</span><span class="sc0">

  </span><span class="sc2">// Posição do primeiro vértice
</span><span class="sc0">  </span><span class="sc11">triangulo</span><span class="sc10">[</span><span class="sc4">0</span><span class="sc10">].</span><span class="sc11">SetPosition</span><span class="sc10">(</span><span class="sc11">p0</span><span class="sc10">);</span><span class="sc0">

  </span><span class="sc2">// Posição do primeiro vértice      
</span><span class="sc0">  </span><span class="sc11">triangulo</span><span class="sc10">[</span><span class="sc4">1</span><span class="sc10">].</span><span class="sc11">SetPosition</span><span class="sc10">(</span><span class="sc11">p1</span><span class="sc10">);</span><span class="sc0">

  </span><span class="sc2">// Posição do primeiro vértice      
</span><span class="sc0">  </span><span class="sc11">triangulo</span><span class="sc10">[</span><span class="sc4">2</span><span class="sc10">].</span><span class="sc11">SetPosition</span><span class="sc10">(</span><span class="sc11">p2</span><span class="sc10">);</span><span class="sc0">
  
</span><span class="sc10">}</span><span class="sc0"> </span><span class="sc2">// montar_triangulo().fim 
</span></div>
<span class="sc2">// Pega as dimensões da tela</span>
<span class="sc16">int</span><span class="sc0"> </span><span class="sc11">altura</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">this</span><span class="sc10">.</span><span class="sc11">Height</span><span class="sc10">;</span>
<span class="sc16">int</span><span class="sc0"> </span><span class="sc11">largura</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">this</span><span class="sc10">.</span><span class="sc11">Width</span><span class="sc10">;</span>
Pegamos com este código as  dimensões  da  janela  que  podem  variar
conforme as ações  do  usuário de aumentar,  reduzir ou maximizar seu
tamanho. O posicionamento dos vértices vai utilizar um percentual da
dimensão da janela acompanhando suas variações.


<span class="sc2">// Cores para os vértices</span>
<span class="sc16">const int</span><span class="sc0"> </span><span class="sc11">vermelho</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0xFF0000</span><span class="sc10">;</span>
<span class="sc16">const int</span><span class="sc0"> </span><span class="sc11">verde</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0x00FF00</span><span class="sc10">;</span>
<span class="sc16">const int</span><span class="sc0"> </span><span class="sc11">azul</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0x0000FF</span><span class="sc10">;</span>
Aqui  definimos constantes de cores no formato RGB  para  colorir  os
vértices. Preste atenção na ilustração do programa e perceba que a cor
do vértice se esparrama e se mistura uma com as outras pelo triângulo.

<span class=sc2>// É necessário 3 vértices para compor o triângulo</span>
triangulo = <b class=prg>new CustomVertex.TransformedColored</b>[3];
A classe <b class=prg>CustomVertex</b> é um recipiente de estruturas que definem vários
formatos de vértice nos quais os  objetos  3D  podem  ser  formatados, 
com  <span class=prg>TransformedColored</span>  sendo  o formato de vértice que comporta uma
posição 3D transformada e informação de cor. Então cada  elemento  da
array <b>triangulo</b> é uma instância da estrutura  <span class=prg>TransformedColored</span>  com 
propriedades e alguns métodos. <span class=prg>Color</span> é  a  propriedade que recebe uma
cor; <span class=prg>SetPosition()</span>  é  o  método que vai receber a posição do vértice 
junto com intensidade de cor codificados numa estrutura <b class=prg>Vector4.</b>

<span class=sc2>// Vetores para guardar a posição (x,y,z) dos vértices e 
// informação de cor</span>
<b class=prg>Vector4</b> p0, p1, p2;
Estes vetores recebem a posição final dos vértices na tela já que eles
não sofrerão transformações posteriores.O quarto <span class=prg>float</span> dessa estrutura
é interpretado como intensidade de propagação da cor do vértice.

<span class=sc2>// O tamanho do triangulo vai adaptar-se interativamente
// ao tamanho da janela</span>
<span class=prg>float</span> meia_largura = largura / 2.0f;
<span class=prg>float</span> larg_80p = largura * 0.8f;
<span class=prg>float</span> larg_20p = largura * 0.2f;
<span class=prg>float</span> alt_80p = altura * 0.8f;
Estes  valores  representam  percentuais  do  tamanho da janela e são
atualizados  toda vez que o tamanho da janela é modificado mantendo o
tamanho  do  nosso  triângulo visualizado  proporcional ao tamanho da
janela.

<span class=sc2>// Posicionamento de profundidade</span>
<span class=prg>float</span> zpos = 0.5f;
A variável <b>zpos</b> representa a profundidade  de uma coordenada 3D. Aqui
este  argumento  vai  ser  ignorado por nossa aplicação uma vez que o 
vértice vai receber a coordenada 2D final. 

<span class=sc2>// Intensidade de propagação de cor do vértice</span>
<span class=prg>float</span> p0_cor_intensidade = 1.0f;
<span class=prg>float</span> p1_cor_intensidade = 1.0f;
<span class=prg>float</span> p2_cor_intensidade = 1.0f;
Teste variações na intensidade de cor dos vértices para assimilar pela
experiência os efeitos práticos dessa configuração de cor.

<span class=sc2>// Define a cor dos vértices</span>
<span class=prg>triangulo[0].Color = vermelho;
triangulo[1].Color = verde;
triangulo[2].Color = azul;</span>
Experimente configurar esta propriedade com as cores pré-definidas do
namespace <b class=prg>System.Drawing</b>,  por exemplo,  a cor vermelha  poderia  ser 
configurada dessa forma:
<span class=prg>triangulo[2].Color = <b>System.Drawing.Color.Red.ToArgb();</b></span>

<span class=sc2>// Posições para os 3 vértices do triângulo</span>
p0 = <b class=prg>new Vector4</b>(meia_largura, 50.0f, zpos, p0_cor_intensidade);
p1 = <b class=prg>new Vector4</b>(larg_80p, alt_80p, zpos, p1_cor_intensidade);
p2 = <b class=prg>new Vector4</b>(larg_20p, alt_80p, zpos, p2_cor_intensidade);
Aqui configuramos o vetor com a posição  final  dos  vértices  e  sua 
intensidade de cor.

<span class=sc2>// Posição do primeiro, segundo e terceiro vértice</span>
<span class=prg>triangulo[0].SetPosition(p0);    
triangulo[1].SetPosition(p1);
triangulo[2].SetPosition(p2);</span>
Aqui  é aonde de fato o vértice recebe seu posicionamento efetivo e a
informação de cor.

Bem,  é  bastante código  para mostrar apenas um triângulo colorido na
tela.Certamente é bem mais complicado mostrar um modelo 3d texturizado
como milhares de vértices.  Mas essa complicação no código é amenizada
porque os modelos 3d geralmente vão vir de arquivos do disco.

<b><u>2.3 Renderizando o triângulo</b></u>
<div class=niceview>
<span class="sc5">public</span><span class="sc0"> </span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">Renderizar</span><span class="sc10">()</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
  </span><span class="sc2">// Limpa os dispositivos e os buffers de apoio
</span><span class="sc0">  </span><span class="sc11">device</span><span class="sc10">.</span><span class="sc11">Clear</span><span class="sc10">(</span><span class="sc11">ClearFlags</span><span class="sc10">.</span><span class="sc11">Target</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">cor_fundo</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">1.0f</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">

  </span><span class="sc2">// Monta o contexto de renderização
</span><span class="sc0">  </span><span class="sc11">device</span><span class="sc10">.</span><span class="sc11">BeginScene</span><span class="sc10">();</span><span class="sc0">
 <b> 
  </span><span class="sc2">// (...) Todo o código de desenhar vai aqui 
</span><span class="sc0">  </span><span class="sc2">// Configura o formato de vértice adequado
</span><span class="sc0">  </span><span class="sc11">device</span><span class="sc10">.</span><span class="sc11">VertexFormat</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">CustomVertex</span><span class="sc10">.</span><span class="sc11">TransformedColored</span><span class="sc10">.</span><span class="sc11">Format</span><span class="sc10">;</span><span class="sc0">
  
  </span><span class="sc2">// Monta o triângulo
</span><span class="sc0">  </span><span class="sc11">montar_triangulo</span><span class="sc10">();</span><span class="sc0">
  
  </span><span class="sc2">// Renderiza o triângulo
</span><span class="sc0">  </span><span class="sc11">device</span><span class="sc10">.</span><span class="sc11">DrawUserPrimitives</span><span class="sc10">(</span><span class="sc11">PrimitiveType</span><span class="sc10">.</span><span class="sc11">TriangleList</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">triangulo</span><span class="sc10">);</span><span class="sc0">     
</b>
  </span><span class="sc2">// Desmonta o contexto de renderização
</span><span class="sc0">  </span><span class="sc11">device</span><span class="sc10">.</span><span class="sc11">EndScene</span><span class="sc10">();</span><span class="sc0">

  </span><span class="sc2">// Apresenta a cena renderizada na tela
</span><span class="sc0">  </span><span class="sc11">device</span><span class="sc10">.</span><span class="sc11">Present</span><span class="sc10">();</span><span class="sc0">

  </span><span class="sc2">// Libera a janela para processar outros eventos
</span><span class="sc0">  </span><span class="sc11">Application</span><span class="sc10">.</span><span class="sc11">DoEvents</span><span class="sc10">();</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0"> </span><span class="sc2">// Renderizar().fim</span>
</div>
A cena deve ser renderizada entre <span class=prg>BeginScene()</span> e <span class=prg>EndScene()</span> do objeto
<b class=prg>Device</b>.  A  propriedade   <span class=prg>device.VertexFormat</span>  foi  configurada  para 
corresponder com o formato de vértice utilizado em nosso triângulo; o
dispositivo é informado previamente da formatação da estrutura 3d que
vai renderizar. Montamos nosso objeto 3d em  <b>montar_triangulo()</b>  e  o
método  <b class=prg>DrawUserPrimitives()</b> desenha nossa lista de triângulos que no
nosso caso tem apenas um triângulo.

<b class=prg>DrawUserPrimitives()</b>   precisa ser  notificada  da  forma  como  deve
renderizar a lista de vértices. Podemos renderizar os  vértices  como
pontos, linhas, triângulos vazados, coloridos ou  texturizados  entre
outras possibilidades que vamos ver mais adiante.

<b><u>3. Código fonte do projeto de exemplo: prj_Triangulo</u></b>
<div class=prg-code>
<img src=images\prj_Triangulo.png>

<span class="sc2">// Prj_Triangulo - Arquivo: Program.cs
// Esse projeto ilustra como renderizar um triângulo
// Produzido por www.gameprog.com.br
</span><span class="sc5">using</span><span class="sc0"> </span><span class="sc11">System</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc5">using</span><span class="sc0"> </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">Windows</span><span class="sc10">.</span><span class="sc11">Forms</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc5">namespace</span><span class="sc0"> </span><span class="sc11">prj_Triangulo</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
  </span><span class="sc16">static</span><span class="sc0"> </span><span class="sc16">class</span><span class="sc0"> </span><span class="sc11">Program</span><span class="sc0">
  </span><span class="sc10">{</span><span class="sc0">

    </span><span class="sc16">static</span><span class="sc0"> </span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">Main</span><span class="sc10">()</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
      </span><span class="sc5">using</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">Tela</span><span class="sc0"> </span><span class="sc11">tela</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">Tela</span><span class="sc10">())</span><span class="sc0">
      </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc2">// Mostre a tela
</span><span class="sc0">        </span><span class="sc11">tela</span><span class="sc10">.</span><span class="sc11">Show</span><span class="sc10">();</span><span class="sc0">

        </span><span class="sc2">// Inicialize o dispositivo gráfico
</span><span class="sc0">        </span><span class="sc11">tela</span><span class="sc10">.</span><span class="sc11">initGfx</span><span class="sc10">();</span><span class="sc0">

        </span><span class="sc2">// Rode a aplicação adequadamente
</span><span class="sc0">        </span><span class="sc11">Application</span><span class="sc10">.</span><span class="sc11">Run</span><span class="sc10">(</span><span class="sc11">tela</span><span class="sc10">);</span><span class="sc0">

      </span><span class="sc10">}</span><span class="sc0"> </span><span class="sc2">// end using 
</span><span class="sc0">    </span><span class="sc10">}</span><span class="sc0"> </span><span class="sc2">// Main().fim
</span><span class="sc0">  </span><span class="sc10">}</span><span class="sc0"> </span><span class="sc2">// fim da classe
</span><span class="sc10">}</span><span class="sc0"> </span><span class="sc2">// fim do namespace
</span><span class="sc15"></div>
</span><span class="sc0">
</span><span class="sc15"><div class=prg-code>
</span><span class="sc2">// Prj_Triangulo - Arquivo: Tela.cs
// Esse projeto ilustra como renderizar um triângulo
// Produzido por www.gameprog.com.br
</span><span class="sc5">using</span><span class="sc0"> </span><span class="sc11">System</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc5">using</span><span class="sc0"> </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">Drawing</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc5">using</span><span class="sc0"> </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">ComponentModel</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc5">using</span><span class="sc0"> </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">Windows</span><span class="sc10">.</span><span class="sc11">Forms</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc5">using</span><span class="sc0"> </span><span class="sc11">Microsoft</span><span class="sc10">.</span><span class="sc11">DirectX</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc5">using</span><span class="sc0"> </span><span class="sc11">Microsoft</span><span class="sc10">.</span><span class="sc11">DirectX</span><span class="sc10">.</span><span class="sc11">Direct3D</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc5">namespace</span><span class="sc0"> </span><span class="sc11">prj_Triangulo</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
  </span><span class="sc5">public</span><span class="sc0"> </span><span class="sc11">partial</span><span class="sc0"> </span><span class="sc16">class</span><span class="sc0"> </span><span class="sc11">Tela</span><span class="sc0"> </span><span class="sc10">:</span><span class="sc0"> </span><span class="sc11">Form</span><span class="sc0">
  </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc5">private</span><span class="sc0"> </span><span class="sc11">Device</span><span class="sc0"> </span><span class="sc11">device</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">null</span><span class="sc10">;</span><span class="sc0">     </span><span class="sc2">// Para criação do dispositivo gráfico
</span><span class="sc0">    </span><span class="sc5">private</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">cor_fundo</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0xFFFFFF</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc2">// Branco cor de fundo para nossa janela   
</span><span class="sc0">
    </span><span class="sc2">// Vértices com configuração de posição e cor
</span><span class="sc0">    </span><span class="sc5">private</span><span class="sc0"> </span><span class="sc11">CustomVertex</span><span class="sc10">.</span><span class="sc11">TransformedColored</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc11">triangulo</span><span class="sc10">;</span><span class="sc0">

    </span><span class="sc2">// Construtor
</span><span class="sc0">    </span><span class="sc5">public</span><span class="sc0"> </span><span class="sc11">Tela</span><span class="sc10">()</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
      </span><span class="sc2">// Qualquer configuração em algum componente, faça depois dessa função!
</span><span class="sc0">      </span><span class="sc2">// Pois a geração automática de código pode suprimir algo que você
</span><span class="sc0">      </span><span class="sc2">// fizer antes dela
</span><span class="sc0">      </span><span class="sc11">InitializeComponent</span><span class="sc10">();</span><span class="sc0">

      </span><span class="sc2">// Toda renderização deverá ocorrer dentro do evento onPaint()
</span><span class="sc0">      </span><span class="sc2">// Isso evita interferência estrangeira de processamento default
</span><span class="sc0">      </span><span class="sc2">// do sistema Windows
</span><span class="sc0">      </span><span class="sc5">this</span><span class="sc10">.</span><span class="sc11">SetStyle</span><span class="sc10">(</span><span class="sc11">ControlStyles</span><span class="sc10">.</span><span class="sc11">AllPaintingInWmPaint</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0"> 
      </span><span class="sc11">ControlStyles</span><span class="sc10">.</span><span class="sc11">Opaque</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">true</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0"> </span><span class="sc2">// fim do construtor
</span><span class="sc0">
    </span><span class="sc5">public</span><span class="sc0"> </span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">initGfx</span><span class="sc10">()</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">

      </span><span class="sc2">// Configuração dos parâmetros de apresentação
</span><span class="sc0">      </span><span class="sc11">PresentParameters</span><span class="sc0"> </span><span class="sc11">pps</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">PresentParameters</span><span class="sc10">();</span><span class="sc0">
      </span><span class="sc11">pps</span><span class="sc10">.</span><span class="sc11">Windowed</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">true</span><span class="sc10">;</span><span class="sc0">
      </span><span class="sc11">pps</span><span class="sc10">.</span><span class="sc11">SwapEffect</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">SwapEffect</span><span class="sc10">.</span><span class="sc11">Discard</span><span class="sc10">;</span><span class="sc0">

      </span><span class="sc2">// Adaptador default, processamento no hardware, processamento de vértice
</span><span class="sc0">      </span><span class="sc2">// no software, janela (this), parâmetros de apresentação (pps)
</span><span class="sc0">      </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">adaptador</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
      </span><span class="sc11">device</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">Device</span><span class="sc10">(</span><span class="sc11">adaptador</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">DeviceType</span><span class="sc10">.</span><span class="sc11">Hardware</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">this</span><span class="sc10">,</span><span class="sc0">
        </span><span class="sc11">CreateFlags</span><span class="sc10">.</span><span class="sc11">SoftwareVertexProcessing</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">pps</span><span class="sc10">);</span><span class="sc0">

      </span><span class="sc2">// Configura a camera
</span><span class="sc0">      </span><span class="sc11">SetupCamera</span><span class="sc10">();</span><span class="sc0">

    </span><span class="sc10">}</span><span class="sc0"> </span><span class="sc2">// initGfx()
</span><span class="sc0">
    </span><span class="sc5">private</span><span class="sc0"> </span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">SetupCamera</span><span class="sc10">()</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">

      </span><span class="sc2">// Dados para a configuração da matriz de projeção
</span><span class="sc0">      </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">largura</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">this</span><span class="sc10">.</span><span class="sc11">Width</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc2">// largura da janela
</span><span class="sc0">      </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">altura</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">this</span><span class="sc10">.</span><span class="sc11">Height</span><span class="sc10">;</span><span class="sc0">  </span><span class="sc2">// altura da janela      
</span><span class="sc0">      </span><span class="sc16">float</span><span class="sc0"> </span><span class="sc11">aspecto</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">largura</span><span class="sc0"> </span><span class="sc10">/</span><span class="sc0"> </span><span class="sc11">altura</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc2">// aspecto dos gráficos      
</span><span class="sc0">      </span><span class="sc16">float</span><span class="sc0"> </span><span class="sc11">campo_visao</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">float</span><span class="sc10">)</span><span class="sc11">Math</span><span class="sc10">.</span><span class="sc11">PI</span><span class="sc0"> </span><span class="sc10">/</span><span class="sc0"> </span><span class="sc4">4</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc2">// Campo de visão
</span><span class="sc0">      </span><span class="sc16">float</span><span class="sc0"> </span><span class="sc11">corte_perto</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">1.0f</span><span class="sc10">;</span><span class="sc0">
      </span><span class="sc16">float</span><span class="sc0"> </span><span class="sc11">corte_longe</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">100.0f</span><span class="sc10">;</span><span class="sc0">

      </span><span class="sc2">// Configura a matriz de projeção
</span><span class="sc0">      </span><span class="sc11">device</span><span class="sc10">.</span><span class="sc11">Transform</span><span class="sc10">.</span><span class="sc11">Projection</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">Matrix</span><span class="sc10">.</span><span class="sc11">PerspectiveFovLH</span><span class="sc10">(</span><span class="sc11">campo_visao</span><span class="sc10">,</span><span class="sc0">
          </span><span class="sc11">aspecto</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">corte_perto</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">corte_longe</span><span class="sc10">);</span><span class="sc0">

      </span><span class="sc2">// Dados para a configuração da matriz de visualização
</span><span class="sc0">      </span><span class="sc11">Vector3</span><span class="sc0"> </span><span class="sc11">cam_pos</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">Vector3</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">18.0f</span><span class="sc10">);</span><span class="sc0"> </span><span class="sc2">// Posição da camera
</span><span class="sc0">      </span><span class="sc11">Vector3</span><span class="sc0"> </span><span class="sc11">cam_alvo</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">Vector3</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">1.0f</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0"> </span><span class="sc2">// Alvo da câmera
</span><span class="sc0">      </span><span class="sc11">Vector3</span><span class="sc0"> </span><span class="sc11">cam_orientacao</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">Vector3</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">1.0f</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0"> </span><span class="sc2">// Orientação da câmera
</span><span class="sc0">
      </span><span class="sc2">// Configura a matriz de visualização
</span><span class="sc0">      </span><span class="sc11">device</span><span class="sc10">.</span><span class="sc11">Transform</span><span class="sc10">.</span><span class="sc11">View</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">Matrix</span><span class="sc10">.</span><span class="sc11">LookAtLH</span><span class="sc10">(</span><span class="sc11">cam_pos</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">cam_alvo</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">cam_orientacao</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">  </span><span class="sc2">// setupCamera()
</span><span class="sc0">
    </span><span class="sc5">public</span><span class="sc0"> </span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">Renderizar</span><span class="sc10">()</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
      </span><span class="sc2">// Limpa os dispositivos e os buffers de apoio
</span><span class="sc0">      </span><span class="sc11">device</span><span class="sc10">.</span><span class="sc11">Clear</span><span class="sc10">(</span><span class="sc11">ClearFlags</span><span class="sc10">.</span><span class="sc11">Target</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">cor_fundo</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">1.0f</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">

      </span><span class="sc2">// Monta o contexto de renderização
</span><span class="sc0">      </span><span class="sc11">device</span><span class="sc10">.</span><span class="sc11">BeginScene</span><span class="sc10">();</span><span class="sc0">
      
      </span><span class="sc2">// (...) Todo o código de desenhar vai aqui 
</span><span class="sc0">      </span><span class="sc11">device</span><span class="sc10">.</span><span class="sc11">VertexFormat</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">CustomVertex</span><span class="sc10">.</span><span class="sc11">TransformedColored</span><span class="sc10">.</span><span class="sc11">Format</span><span class="sc10">;</span><span class="sc0">
      </span><span class="sc11">montar_triangulo</span><span class="sc10">();</span><span class="sc0">
      </span><span class="sc11">device</span><span class="sc10">.</span><span class="sc11">DrawUserPrimitives</span><span class="sc10">(</span><span class="sc11">PrimitiveType</span><span class="sc10">.</span><span class="sc11">TriangleList</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">triangulo</span><span class="sc10">);</span><span class="sc0">     

      </span><span class="sc2">// Desmonta o contexto de renderização
</span><span class="sc0">      </span><span class="sc11">device</span><span class="sc10">.</span><span class="sc11">EndScene</span><span class="sc10">();</span><span class="sc0">

      </span><span class="sc2">// Apresenta a cena renderizada na tela
</span><span class="sc0">      </span><span class="sc11">device</span><span class="sc10">.</span><span class="sc11">Present</span><span class="sc10">();</span><span class="sc0">

      </span><span class="sc2">// Libera a janela para processar outros eventos
</span><span class="sc0">      </span><span class="sc11">Application</span><span class="sc10">.</span><span class="sc11">DoEvents</span><span class="sc10">();</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0"> </span><span class="sc2">// Renderizar().fim
</span><span class="sc0">
    </span><span class="sc5">protected</span><span class="sc0"> </span><span class="sc5">override</span><span class="sc0"> </span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">OnPaint</span><span class="sc10">(</span><span class="sc11">PaintEventArgs</span><span class="sc0"> </span><span class="sc11">e</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
      </span><span class="sc2">// Trate outros processos padrões
</span><span class="sc0">      </span><span class="sc5">base</span><span class="sc10">.</span><span class="sc11">OnPaint</span><span class="sc10">(</span><span class="sc11">e</span><span class="sc10">);</span><span class="sc0">

      </span><span class="sc2">// Renderize a cena
</span><span class="sc0">      </span><span class="sc5">this</span><span class="sc10">.</span><span class="sc11">Renderizar</span><span class="sc10">();</span><span class="sc0">

      </span><span class="sc2">// Invalide para chamar novamente onPaint()
</span><span class="sc0">      </span><span class="sc5">this</span><span class="sc10">.</span><span class="sc11">Invalidate</span><span class="sc10">();</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0"> </span><span class="sc2">// onPaint().fim 
</span><span class="sc0">
    </span><span class="sc5">public</span><span class="sc0"> </span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">montar_triangulo</span><span class="sc10">()</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
      </span><span class="sc2">// Pega as dimensões da tela
</span><span class="sc0">      </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">altura</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">this</span><span class="sc10">.</span><span class="sc11">Height</span><span class="sc10">;</span><span class="sc0">
      </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">largura</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">this</span><span class="sc10">.</span><span class="sc11">Width</span><span class="sc10">;</span><span class="sc0">

      </span><span class="sc2">// Cores para os vértices
</span><span class="sc0">      </span><span class="sc16">const</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">vermelho</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0xFF0000</span><span class="sc10">;</span><span class="sc0">
      </span><span class="sc16">const</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">verde</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0x00FF00</span><span class="sc10">;</span><span class="sc0">
      </span><span class="sc16">const</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">azul</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0x0000FF</span><span class="sc10">;</span><span class="sc0">

      </span><span class="sc2">// É necessário 3 vértices para compor o triângulo
</span><span class="sc0">      </span><span class="sc11">triangulo</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">CustomVertex</span><span class="sc10">.</span><span class="sc11">TransformedColored</span><span class="sc10">[</span><span class="sc4">3</span><span class="sc10">];</span><span class="sc0">
      
      </span><span class="sc2">// Vetores para guardar a posição (x, y, z ) dos vértices e mais
</span><span class="sc0">      </span><span class="sc2">// uma informação de cor
</span><span class="sc0">      </span><span class="sc11">Vector4</span><span class="sc0"> </span><span class="sc11">p0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">p1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">p2</span><span class="sc10">;</span><span class="sc0">

      </span><span class="sc2">// O tamanho do triangulo vai adaptar-se interativamente
</span><span class="sc0">      </span><span class="sc2">// ao tamanho da janela
</span><span class="sc0">      </span><span class="sc16">float</span><span class="sc0"> </span><span class="sc11">meia_largura</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">largura</span><span class="sc0"> </span><span class="sc10">/</span><span class="sc0"> </span><span class="sc4">2.0f</span><span class="sc10">;</span><span class="sc0">
      </span><span class="sc16">float</span><span class="sc0"> </span><span class="sc11">larg_80p</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">largura</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc0"> </span><span class="sc4">0.8f</span><span class="sc10">;</span><span class="sc0">
      </span><span class="sc16">float</span><span class="sc0"> </span><span class="sc11">larg_20p</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">largura</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc0"> </span><span class="sc4">0.2f</span><span class="sc10">;</span><span class="sc0">
      </span><span class="sc16">float</span><span class="sc0"> </span><span class="sc11">alt_80p</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">altura</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc0"> </span><span class="sc4">0.8f</span><span class="sc10">;</span><span class="sc0">

      </span><span class="sc2">// Posicionamento de profundidade
</span><span class="sc0">      </span><span class="sc16">float</span><span class="sc0"> </span><span class="sc11">zpos</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc4">0.5f</span><span class="sc10">;</span><span class="sc0">
      
      </span><span class="sc2">// Intensidade de propagação de cor do vértice
</span><span class="sc0">      </span><span class="sc16">float</span><span class="sc0"> </span><span class="sc11">p0_cor_intensidade</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">1.0f</span><span class="sc10">;</span><span class="sc0">
      </span><span class="sc16">float</span><span class="sc0"> </span><span class="sc11">p1_cor_intensidade</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">1.0f</span><span class="sc10">;</span><span class="sc0">
      </span><span class="sc16">float</span><span class="sc0"> </span><span class="sc11">p2_cor_intensidade</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">1.0f</span><span class="sc10">;</span><span class="sc0">

      </span><span class="sc2">// Define a cor dos vértices
</span><span class="sc0">      </span><span class="sc11">triangulo</span><span class="sc10">[</span><span class="sc4">0</span><span class="sc10">].</span><span class="sc11">Color</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">vermelho</span><span class="sc10">;</span><span class="sc0">
      </span><span class="sc11">triangulo</span><span class="sc10">[</span><span class="sc4">1</span><span class="sc10">].</span><span class="sc11">Color</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">verde</span><span class="sc10">;</span><span class="sc0">
      </span><span class="sc11">triangulo</span><span class="sc10">[</span><span class="sc4">2</span><span class="sc10">].</span><span class="sc11">Color</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">azul</span><span class="sc10">;</span><span class="sc0">

      </span><span class="sc2">// Posições para os 3 vértices do triangulo
</span><span class="sc0">      </span><span class="sc11">p0</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">Vector4</span><span class="sc10">(</span><span class="sc11">meia_largura</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">50.0f</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">zpos</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">p0_cor_intensidade</span><span class="sc10">);</span><span class="sc0">
      </span><span class="sc11">p1</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">Vector4</span><span class="sc10">(</span><span class="sc11">larg_80p</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">alt_80p</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">zpos</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">p1_cor_intensidade</span><span class="sc10">);</span><span class="sc0">
      </span><span class="sc11">p2</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">Vector4</span><span class="sc10">(</span><span class="sc11">larg_20p</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">alt_80p</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">zpos</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">p2_cor_intensidade</span><span class="sc10">);</span><span class="sc0">

      </span><span class="sc2">// Posição do primeiro vértice
</span><span class="sc0">      </span><span class="sc11">triangulo</span><span class="sc10">[</span><span class="sc4">0</span><span class="sc10">].</span><span class="sc11">SetPosition</span><span class="sc10">(</span><span class="sc11">p0</span><span class="sc10">);</span><span class="sc0">

      </span><span class="sc2">// Posição do primeiro vértice      
</span><span class="sc0">      </span><span class="sc11">triangulo</span><span class="sc10">[</span><span class="sc4">1</span><span class="sc10">].</span><span class="sc11">SetPosition</span><span class="sc10">(</span><span class="sc11">p1</span><span class="sc10">);</span><span class="sc0">

      </span><span class="sc2">// Posição do primeiro vértice      
</span><span class="sc0">      </span><span class="sc11">triangulo</span><span class="sc10">[</span><span class="sc4">2</span><span class="sc10">].</span><span class="sc11">SetPosition</span><span class="sc10">(</span><span class="sc11">p2</span><span class="sc10">);</span><span class="sc0">      
      
    </span><span class="sc10">}</span><span class="sc0"> </span><span class="sc2">// montar_triangulo().fim 
</span><span class="sc0">
  </span><span class="sc10">}</span><span class="sc0"> </span><span class="sc2">// fim da classe
</span><span class="sc10">}</span><span class="sc0"> </span><span class="sc2">// fim do namespace
</span></div>

<div class=prg-code>
<span class="sc2">// Prj_Triangulo - Arquivo: Tela.Designer.cs
// Esse projeto ilustra como renderizar um triângulo
// Produzido por www.gameprog.com.br
</span><span class="sc5">namespace</span><span class="sc0"> </span><span class="sc11">prj_Triangulo</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
  </span><span class="sc11">partial</span><span class="sc0"> </span><span class="sc16">class</span><span class="sc0"> </span><span class="sc11">Tela</span><span class="sc0">
  </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc15">/// &lt;summary&gt;
</span><span class="sc0">    </span><span class="sc15">/// Required designer variable.
</span><span class="sc0">    </span><span class="sc15">/// &lt;/summary&gt;
</span><span class="sc0">    </span><span class="sc5">private</span><span class="sc0"> </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">ComponentModel</span><span class="sc10">.</span><span class="sc11">IContainer</span><span class="sc0"> </span><span class="sc11">components</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">null</span><span class="sc10">;</span><span class="sc0">

    </span><span class="sc15">/// &lt;summary&gt;
</span><span class="sc0">    </span><span class="sc15">/// Clean up any resources being used.
</span><span class="sc0">    </span><span class="sc15">/// &lt;/summary&gt;
</span><span class="sc0">    </span><span class="sc15">/// &lt;param name="disposing"&gt;true if managed resources should be disposed; otherwise, false.&lt;/param&gt;
</span><span class="sc0">    </span><span class="sc5">protected</span><span class="sc0"> </span><span class="sc5">override</span><span class="sc0"> </span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">Dispose</span><span class="sc10">(</span><span class="sc16">bool</span><span class="sc0"> </span><span class="sc11">disposing</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
      </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">disposing</span><span class="sc0"> </span><span class="sc10">&amp;&amp;</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">components</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc5">null</span><span class="sc10">))</span><span class="sc0">
      </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">components</span><span class="sc10">.</span><span class="sc11">Dispose</span><span class="sc10">();</span><span class="sc0">
      </span><span class="sc10">}</span><span class="sc0">
      </span><span class="sc5">base</span><span class="sc10">.</span><span class="sc11">Dispose</span><span class="sc10">(</span><span class="sc11">disposing</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">

    </span><span class="sc9">#region Windows Form Designer generated code
</span><span class="sc0">
    </span><span class="sc15">/// &lt;summary&gt;
</span><span class="sc0">    </span><span class="sc15">/// Required method for Designer support - do not modify
</span><span class="sc0">    </span><span class="sc15">/// the contents of this method with the code editor.
</span><span class="sc0">    </span><span class="sc15">/// &lt;/summary&gt;
</span><span class="sc0">    </span><span class="sc5">private</span><span class="sc0"> </span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">InitializeComponent</span><span class="sc10">()</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
      </span><span class="sc5">this</span><span class="sc10">.</span><span class="sc11">SuspendLayout</span><span class="sc10">();</span><span class="sc0">
      </span><span class="sc2">// 
</span><span class="sc0">      </span><span class="sc2">// Tela
</span><span class="sc0">      </span><span class="sc2">// 
</span><span class="sc0">      </span><span class="sc5">this</span><span class="sc10">.</span><span class="sc11">AutoScaleDimensions</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">Drawing</span><span class="sc10">.</span><span class="sc11">SizeF</span><span class="sc10">(</span><span class="sc4">6F</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">13F</span><span class="sc10">);</span><span class="sc0">
      </span><span class="sc5">this</span><span class="sc10">.</span><span class="sc11">AutoScaleMode</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">Windows</span><span class="sc10">.</span><span class="sc11">Forms</span><span class="sc10">.</span><span class="sc11">AutoScaleMode</span><span class="sc10">.</span><span class="sc11">Font</span><span class="sc10">;</span><span class="sc0">
      </span><span class="sc5">this</span><span class="sc10">.</span><span class="sc11">ClientSize</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">Drawing</span><span class="sc10">.</span><span class="sc11">Size</span><span class="sc10">(</span><span class="sc4">292</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">273</span><span class="sc10">);</span><span class="sc0">
      </span><span class="sc5">this</span><span class="sc10">.</span><span class="sc11">Name</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"Tela"</span><span class="sc10">;</span><span class="sc0">
      </span><span class="sc5">this</span><span class="sc10">.</span><span class="sc11">Text</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"prj_Triangulo"</span><span class="sc10">;</span><span class="sc0">      
      </span><span class="sc5">this</span><span class="sc10">.</span><span class="sc11">ResumeLayout</span><span class="sc10">(</span><span class="sc5">false</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0"> </span><span class="sc2">// ().fim
</span><span class="sc0">
    </span><span class="sc9">#endregion
</span><span class="sc0">  </span><span class="sc10">}</span><span class="sc0"> </span><span class="sc2">// fim da classe
</span><span class="sc10">}</span><span class="sc0"> </span><span class="sc2">// fim do namespace
</span></div>
<hr>
<table align="bottom" border="0" cellspacing="0" cellpadding="0" width="20%">
<tr><td><a href="mdx9.html#start" style="color:blue"> index </a></td>
<td><a href="track01-2.html" style="color:blue">&lt;&lt;</a></td>
<td><a href="track01-4.html" style="color:blue">&gt;&gt;</a></td></tr></table><pre>
<hr><div style="background-color:lightyellow;color:blue">
<center>Produzido por Gameprog: Jair Pereira - Março/2014 ©
gameprog.br@gmail.com
http://www.gameprog.com.br</center><hr></div></div></body></html>